(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5524],{8918:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});var s=l(95155),a=l(67909),n=l(12115);l(84876),l(70117);let i=(0,a.default)(()=>Promise.all([l.e(1563),l.e(2141),l.e(6333)]).then(l.bind(l,36333)),{loadableGenerated:{webpack:()=>[null]},ssr:!1});function r(e){let{value:t,onChange:l,placeholder:a="마크다운으로 작성하세요...",height:r=400,minHeight:c=300}=e,[o,d]=(0,n.useState)("live");return(0,s.jsxs)("div",{className:"markdown-editor-wrapper","data-color-mode":"dark",children:[(0,s.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>d("edit"),className:"px-3 py-1 text-sm rounded transition-colors ".concat("edit"===o?"bg-neutral-700 text-white":"bg-neutral-900 text-neutral-400 hover:text-white"),children:"편집"}),(0,s.jsx)("button",{type:"button",onClick:()=>d("live"),className:"px-3 py-1 text-sm rounded transition-colors ".concat("live"===o?"bg-neutral-700 text-white":"bg-neutral-900 text-neutral-400 hover:text-white"),children:"실시간"}),(0,s.jsx)("button",{type:"button",onClick:()=>d("preview"),className:"px-3 py-1 text-sm rounded transition-colors ".concat("preview"===o?"bg-neutral-700 text-white":"bg-neutral-900 text-neutral-400 hover:text-white"),children:"미리보기"})]}),(0,s.jsx)(i,{value:t,onChange:e=>l(e||""),preview:o,height:r,minHeight:c,textareaProps:{placeholder:a},style:{backgroundColor:"#171717",borderRadius:"0.5rem"},previewOptions:{style:{backgroundColor:"#171717"}}}),(0,s.jsx)("p",{className:"text-neutral-600 text-xs mt-2",children:"마크다운 문법을 지원합니다. # 제목, **굵게**, *기울임*, `코드`, [링크](url) 등"})]})}},10479:(e,t,l)=>{Promise.resolve().then(l.bind(l,22148))},22148:(e,t,l)=>{"use strict";l.d(t,{default:()=>B});var s=l(95155),a=l(12115),n=l(2369),i=l(67661),r=l(70305),c=l(25832),o=l(96778),d=l(41970),u=l(40387),p=l(63090),h=l(82726),x=l(17998),g=l(77147),m=l(67623),j=l(60688),b=l(92364),v=l(6132),f=l(42529),S=l(86237),T=l(8918),y=l(64118),w=l(37621);let k=(0,a.createContext)(null);function C(){let e=(0,a.useContext)(k);if(!e)throw Error("useNav must be used within NavProvider");return e}function z(){let{navigate:e}=C(),[t,l]=(0,a.useState)([]),[m,j]=(0,a.useState)(!0),[b,f]=(0,a.useState)(""),[T,y]=(0,a.useState)(null),[k,z]=(0,a.useState)("all");(0,a.useEffect)(()=>{E()},[]);let E=async()=>{try{j(!0);let e=await w.bG.list(),t=Array.isArray(e)?e:[];l(t)}catch(e){f(e instanceof Error?e.message:"블로그 글 목록을 불러오는데 실패했습니다")}finally{j(!1)}},G=async e=>{let s=localStorage.getItem("admin_token");if(s)try{await w.bG.delete(e,s),l(t.filter(t=>t.slug!==e)),y(null)}catch(e){f(e instanceof Error?e.message:"삭제에 실패했습니다")}},B=t.filter(e=>"all"===k||("published"===k?e.published:"draft"!==k||!e.published)),P=t.filter(e=>e.published).length,A=t.filter(e=>!e.published).length;return(0,s.jsx)(S.A,{title:"블로그 관리",children:(0,s.jsxs)(n.Stack,{gap:"lg",children:[(0,s.jsxs)(i.Group,{justify:"space-between",align:"flex-end",children:[(0,s.jsxs)(n.Stack,{gap:"xs",children:[(0,s.jsxs)(r.Text,{size:"sm",c:"dimmed",children:["총 ",t.length,"개의 글"]}),(0,s.jsx)(c.SegmentedControl,{value:k,onChange:e=>z(e),size:"xs",data:[{label:"전체 (".concat(t.length,")"),value:"all"},{label:"발행됨 (".concat(P,")"),value:"published"},{label:"임시저장 (".concat(A,")"),value:"draft"}]})]}),(0,s.jsx)(o.Button,{size:"sm",onClick:()=>e({view:"new"}),children:"+ 새 글 작성"})]}),b&&(0,s.jsx)(d.Alert,{icon:(0,s.jsx)(v.A,{size:16}),title:"오류",color:"red",mb:"lg",children:b}),m&&(0,s.jsx)(u.Center,{py:"xl",children:(0,s.jsx)(p.Loader,{})}),!m&&0===t.length&&(0,s.jsx)(u.Center,{py:"xl",children:(0,s.jsxs)(n.Stack,{align:"center",gap:"md",children:[(0,s.jsx)(r.Text,{size:"sm",c:"dimmed",children:"등록된 블로그 글이 없습니다"}),(0,s.jsx)(o.Button,{variant:"subtle",size:"sm",onClick:()=>e({view:"new"}),children:"첫 번째 글을 작성해보세요 →"})]})}),!m&&0===B.length&&t.length>0&&(0,s.jsx)(u.Center,{py:"xl",children:(0,s.jsx)(r.Text,{size:"sm",c:"dimmed",children:"published"===k?"발행된 글이 없습니다":"임시저장된 글이 없습니다"})}),!m&&B.length>0&&(0,s.jsx)(n.Stack,{gap:"md",children:B.map(t=>(0,s.jsx)(h.Paper,{p:"md",radius:"md",withBorder:!0,children:(0,s.jsx)(n.Stack,{gap:"xs",children:(0,s.jsxs)(i.Group,{justify:"space-between",align:"flex-start",children:[(0,s.jsxs)(n.Stack,{gap:"xs",style:{flex:1},children:[(0,s.jsx)(i.Group,{gap:"xs",align:"center",children:(0,s.jsx)(x.Badge,{color:t.published?"green":"gray",variant:"light",size:"sm",children:t.published?"발행됨":"임시저장"})}),(0,s.jsx)(r.Text,{fw:500,size:"md",children:t.title}),t.excerpt&&(0,s.jsx)(r.Text,{size:"sm",c:"dimmed",lineClamp:2,children:t.excerpt}),t.tags&&t.tags.length>0&&(0,s.jsx)(i.Group,{gap:"xs",wrap:"wrap",children:t.tags.map((e,t)=>(0,s.jsx)(x.Badge,{variant:"dot",size:"sm",color:"gray",children:e},t))}),(0,s.jsxs)(r.Text,{size:"xs",c:"dimmed",children:[new Date(t.updated_at).toLocaleDateString("ko-KR")," ","수정"]})]}),(0,s.jsxs)(i.Group,{gap:"xs",children:[(0,s.jsx)(o.Button,{size:"xs",variant:"subtle",onClick:()=>e({view:"edit",slug:t.slug}),children:"편집"}),(0,s.jsx)(g.Anchor,{href:"/blog/".concat(t.slug),target:"_blank",size:"xs",children:"보기"}),T===t.slug?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Button,{size:"xs",color:"red",variant:"subtle",onClick:()=>G(t.slug),children:"확인"}),(0,s.jsx)(o.Button,{size:"xs",variant:"subtle",onClick:()=>y(null),children:"취소"})]}):(0,s.jsx)(o.Button,{size:"xs",color:"red",variant:"subtle",onClick:()=>y(t.slug),children:"삭제"})]})]})})},t.id))})]})})}function E(){let{navigate:e,goBack:t}=C(),[l,c]=(0,a.useState)(!1),[u,p]=(0,a.useState)(""),[h,x]=(0,a.useState)({title:"",content:"",excerpt:"",tags:[],published:!1}),g=async function(t){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.preventDefault(),p(""),c(!0);let s=localStorage.getItem("admin_token");if(!s){p("로그인이 필요합니다"),c(!1);return}try{await w.bG.create({...h,published:l},s),e({view:"list"})}catch(e){p(e instanceof Error?e.message:"블로그 글 생성에 실패했습니다")}finally{c(!1)}};return(0,s.jsx)(S.A,{title:"새 블로그 글",onBack:t,backLabel:"← 블로그 목록",children:(0,s.jsx)(m.Box,{component:"form",onSubmit:e=>g(e,!1),maw:600,children:(0,s.jsxs)(n.Stack,{gap:"xl",children:[u&&(0,s.jsx)(d.Alert,{icon:(0,s.jsx)(v.A,{size:16}),title:"오류",color:"red",children:u}),(0,s.jsx)(j.TextInput,{label:"제목 *",placeholder:"블로그 글 제목을 입력하세요",value:h.title,onChange:e=>x({...h,title:e.target.value}),required:!0,disabled:l,size:"sm"}),(0,s.jsx)(r.Text,{size:"xs",c:"dimmed",children:"URL 슬러그는 UUID를 기반으로 자동 생성됩니다"}),(0,s.jsx)(b.Textarea,{label:"요약",placeholder:"목록에 표시될 간단한 요약을 입력하세요",value:h.excerpt,onChange:e=>x({...h,excerpt:e.target.value}),minRows:3,disabled:l,size:"sm"}),(0,s.jsxs)(n.Stack,{gap:"xs",children:[(0,s.jsx)(r.Text,{size:"sm",fw:500,children:"태그"}),(0,s.jsx)(y.A,{tags:h.tags,onChange:e=>x({...h,tags:e}),placeholder:"주제, 카테고리 등을 입력하세요"}),(0,s.jsx)(r.Text,{size:"xs",c:"dimmed",children:"Enter 또는 쉼표로 태그를 추가하세요"})]}),(0,s.jsxs)(n.Stack,{gap:"xs",children:[(0,s.jsx)(r.Text,{size:"sm",fw:500,children:"본문 *"}),(0,s.jsx)(T.A,{value:h.content,onChange:e=>x({...h,content:e}),placeholder:"블로그 글을 마크다운으로 작성하세요...",height:500,minHeight:400}),(0,s.jsx)(i.Group,{justify:"flex-end",children:(0,s.jsxs)(r.Text,{size:"xs",c:"dimmed",children:[h.content.length.toLocaleString(),"자"]})})]}),(0,s.jsxs)(n.Stack,{gap:"md",pt:"md",children:[(0,s.jsx)(r.Text,{size:"sm",c:"dimmed",children:"“발행하기”를 누르면 즉시 공개됩니다. 임시저장하면 나중에 발행할 수 있습니다."}),(0,s.jsxs)(i.Group,{gap:"md",children:[(0,s.jsx)(o.Button,{type:"button",onClick:e=>g(e,!0),disabled:l||!h.title||!h.content,loading:l,children:"발행하기"}),(0,s.jsx)(o.Button,{type:"submit",variant:"light",disabled:l||!h.title||!h.content,loading:l,children:"임시저장"}),(0,s.jsx)(o.Button,{type:"button",variant:"subtle",onClick:t,disabled:l,children:"취소"})]})]})]})})})}function G(e){let{slug:t}=e,{navigate:l,goBack:h}=C(),[x,g]=(0,a.useState)(!1),[k,z]=(0,a.useState)(!0),[E,G]=(0,a.useState)(""),[B,P]=(0,a.useState)(""),[A,_]=(0,a.useState)({title:"",slug:"",content:"",excerpt:"",tags:[],published:!1}),L=(0,a.useCallback)(async()=>{try{z(!0);let e=await w.bG.getBySlug(t);_({title:e.title||"",slug:e.slug||"",content:e.content||"",excerpt:e.excerpt||"",tags:e.tags||[],published:e.published||!1})}catch(e){G(e instanceof Error?e.message:"블로그 글을 불러오는데 실패했습니다")}finally{z(!1)}},[t]);(0,a.useEffect)(()=>{L()},[L]);let N=async(e,l)=>{e.preventDefault(),G(""),g(!0);let s=localStorage.getItem("admin_token");if(!s){G("로그인이 필요합니다"),g(!1);return}let a={...A,published:void 0!==l?l:A.published};try{await w.bG.update(t,a,s),_(e=>({...e,published:a.published})),P("저장되었습니다!"),setTimeout(()=>P(""),3e3)}catch(e){G(e instanceof Error?e.message:"블로그 글 수정에 실패했습니다")}finally{g(!1)}};return k?(0,s.jsx)(S.A,{title:"블로그 글 수정",onBack:h,backLabel:"← 블로그 목록",children:(0,s.jsx)(u.Center,{py:"xl",children:(0,s.jsx)(p.Loader,{})})}):(0,s.jsx)(S.A,{title:"블로그 글 수정",onBack:h,backLabel:"← 블로그 목록",children:(0,s.jsx)(m.Box,{component:"form",onSubmit:e=>N(e),maw:600,children:(0,s.jsxs)(n.Stack,{gap:"xl",children:[B&&(0,s.jsx)(d.Alert,{icon:(0,s.jsx)(f.A,{size:16}),title:"완료",color:"green",children:B}),E&&(0,s.jsx)(d.Alert,{icon:(0,s.jsx)(v.A,{size:16}),title:"오류",color:"red",children:E}),(0,s.jsxs)(n.Stack,{gap:"xs",children:[(0,s.jsx)(r.Text,{size:"sm",fw:500,children:"상태"}),(0,s.jsx)(c.SegmentedControl,{value:A.published?"published":"draft",onChange:e=>_({...A,published:"published"===e}),disabled:x,data:[{label:"임시저장",value:"draft"},{label:"발행됨",value:"published"}],size:"sm"})]}),(0,s.jsx)(j.TextInput,{label:"제목 *",placeholder:"블로그 글 제목을 입력하세요",value:A.title,onChange:e=>_({...A,title:e.target.value}),required:!0,disabled:x,size:"sm"}),(0,s.jsxs)(n.Stack,{gap:"xs",children:[(0,s.jsx)(r.Text,{size:"sm",fw:500,children:"슬러그 (URL)"}),(0,s.jsxs)(i.Group,{gap:"xs",children:[(0,s.jsx)(r.Text,{size:"sm",c:"dimmed",children:"/blog/"}),(0,s.jsx)(j.TextInput,{placeholder:A.slug,value:A.slug,disabled:!0,size:"sm",style:{flex:1}})]}),(0,s.jsx)(r.Text,{size:"xs",c:"dimmed",children:"슬러그는 생성 시 자동으로 지정되며 변경할 수 없습니다"})]}),(0,s.jsx)(b.Textarea,{label:"요약",placeholder:"목록에 표시될 간단한 요약을 입력하세요",value:A.excerpt,onChange:e=>_({...A,excerpt:e.target.value}),minRows:3,disabled:x,size:"sm"}),(0,s.jsxs)(n.Stack,{gap:"xs",children:[(0,s.jsx)(r.Text,{size:"sm",fw:500,children:"태그"}),(0,s.jsx)(y.A,{tags:A.tags,onChange:e=>_({...A,tags:e}),placeholder:"주제, 카테고리 등을 입력하세요"}),(0,s.jsx)(r.Text,{size:"xs",c:"dimmed",children:"Enter 또는 쉼표로 태그를 추가하세요"})]}),(0,s.jsxs)(n.Stack,{gap:"xs",children:[(0,s.jsx)(r.Text,{size:"sm",fw:500,children:"본문 *"}),(0,s.jsx)(T.A,{value:A.content,onChange:e=>_({...A,content:e}),placeholder:"블로그 글을 마크다운으로 작성하세요...",height:500,minHeight:400}),(0,s.jsx)(i.Group,{justify:"flex-end",children:(0,s.jsxs)(r.Text,{size:"xs",c:"dimmed",children:[A.content.length.toLocaleString(),"자"]})})]}),(0,s.jsxs)(i.Group,{gap:"md",pt:"md",children:[(0,s.jsx)(o.Button,{type:"submit",disabled:x||!A.title||!A.content,loading:x,children:"저장"}),(0,s.jsx)(o.Button,{type:"button",variant:"subtle",onClick:()=>l({view:"list"}),disabled:x,children:"목록으로"})]})]})})})}function B(){let[e,t]=(0,a.useState)({view:"list"}),[l,n]=(0,a.useState)([]),i=(0,a.useCallback)(l=>{n(t=>[...t,e]),t(l)},[e]),r=(0,a.useCallback)(()=>{if(l.length>0){let e=[...l],s=e.pop();n(e),t(s||{view:"list"})}else t({view:"list"})},[l]);return(0,s.jsx)(k.Provider,{value:{navState:e,navigate:i,goBack:r},children:(()=>{switch(e.view){case"new":return(0,s.jsx)(E,{});case"edit":return e.slug?(0,s.jsx)(G,{slug:e.slug}):(0,s.jsx)(z,{});default:return(0,s.jsx)(z,{})}})()})}},37621:(e,t,l)=>{"use strict";l.d(t,{ZQ:()=>n,_H:()=>i,bG:()=>r,nq:()=>c});let s=l(95704).env.NEXT_PUBLIC_API_URL||"http://localhost:8080";async function a(e,t,l,a){let n={"Content-Type":"application/json"};a&&(n.Authorization="Bearer ".concat(a));let i={method:e,headers:n};l&&("POST"===e||"PUT"===e)&&(i.body=JSON.stringify(l));let r=await fetch("".concat(s).concat(t),i);if(!r.ok)throw Error((await r.json().catch(()=>({error:"HTTP ".concat(r.status)}))).error||"API request failed");let c=await r.text();if(c)return JSON.parse(c)}let n={login:e=>a("POST","/api/auth/login",e),register:e=>a("POST","/api/auth/register",e)},i={list:e=>{let t=new URLSearchParams;(null==e?void 0:e.status)&&t.append("status",e.status),(null==e?void 0:e.novel_type)&&t.append("novel_type",e.novel_type),(null==e?void 0:e.genre)&&t.append("genre",e.genre),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.append("offset",e.offset.toString()),(null==e?void 0:e.include_drafts)&&t.append("include_drafts","true");let l=t.toString();return a("GET","/api/novels".concat(l?"?".concat(l):""))},getBySlug:e=>a("GET","/api/novels/".concat(e)),create:(e,t)=>a("POST","/api/novels",e,t),update:(e,t,l)=>a("PUT","/api/novels/".concat(e),t,l),delete:(e,t)=>a("DELETE","/api/novels/".concat(e),void 0,t),getGenres:()=>a("GET","/api/novels/genres"),getNovelTypes:()=>a("GET","/api/novels/types"),getRelations:e=>a("GET","/api/novels/".concat(e,"/relations")),addRelation:(e,t,l)=>a("POST","/api/novels/".concat(e,"/relations"),t,l),removeRelation:(e,t,l)=>a("DELETE","/api/novels/".concat(e,"/relations?related_slug=").concat(t),void 0,l),getChapters:e=>a("GET","/api/novels/".concat(e,"/chapters")),getChapter:(e,t)=>a("GET","/api/novels/".concat(e,"/chapters/").concat(t)),createChapter:(e,t,l)=>a("POST","/api/novels/".concat(e,"/chapters"),t,l),updateChapter:(e,t,l,s)=>a("PUT","/api/novels/".concat(e,"/chapters/").concat(t),l,s),deleteChapter:(e,t,l)=>a("DELETE","/api/novels/".concat(e,"/chapters/").concat(t),void 0,l)},r={list:e=>{let t=new URLSearchParams;(null==e?void 0:e.published)!==void 0&&t.append("published",e.published.toString()),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.append("offset",e.offset.toString());let l=t.toString();return a("GET","/api/blog".concat(l?"?".concat(l):""))},getBySlug:e=>a("GET","/api/blog/".concat(e)),create:(e,t)=>a("POST","/api/blog",e,t),update:(e,t,l)=>a("PUT","/api/blog/".concat(e),t,l),delete:(e,t)=>a("DELETE","/api/blog/".concat(e),void 0,t)},c={list:e=>{let t=new URLSearchParams;(null==e?void 0:e.platform)&&t.append("platform",e.platform),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.append("offset",e.offset.toString());let l=t.toString();return a("GET","/api/apps".concat(l?"?".concat(l):""))},getBySlug:e=>a("GET","/api/apps/".concat(e)),getPlatforms:()=>a("GET","/api/apps/platforms"),getChannels:()=>a("GET","/api/apps/channels"),create:(e,t)=>a("POST","/api/apps",e,t),update:(e,t,l)=>a("PUT","/api/apps/".concat(e),t,l),delete:(e,t)=>a("DELETE","/api/apps/".concat(e),void 0,t)}},64118:(e,t,l)=>{"use strict";l.d(t,{A:()=>n});var s=l(95155),a=l(76503);function n(e){let{tags:t,onChange:l,placeholder:n="태그 입력 후 Enter",maxTags:i=10}=e;return(0,s.jsx)(a.TagsInput,{value:t,onChange:l,placeholder:0===t.length?n:"",maxTags:i,description:"Enter 키로 태그 추가, Backspace로 삭제 (".concat(t.length,"/").concat(i,")"),clearable:!0,splitChars:[","," ","Enter"],acceptValueOnBlur:!0,classNames:{input:"dark:bg-neutral-900 dark:border-neutral-800"}})}},86237:(e,t,l)=>{"use strict";l.d(t,{A:()=>g});var s=l(95155),a=l(52619),n=l.n(a),i=l(20063),r=l(12115),c=l(13877),o=l(63090),d=l(70305),u=l(75802),p=l(67661),h=l(96778),x=l(74264);function g(e){let{children:t,title:l,backHref:a="/admin/dashboard",backLabel:g="← 대시보드",onBack:m}=e,j=(0,i.useRouter)(),[b,v]=(0,r.useState)(null),[f,S]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{let e=localStorage.getItem("admin_token"),t=localStorage.getItem("admin_user");if(!e||!t)return void j.push("/admin/login/");v(JSON.parse(t)),S(!1)},[j]),f)?(0,s.jsxs)(c.Container,{h:"100vh",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,s.jsx)(o.Loader,{color:"gray",size:"sm"}),(0,s.jsx)(d.Text,{size:"sm",c:"dimmed",ml:"sm",children:"로딩 중..."})]}):(0,s.jsx)(u.AppShell,{header:{height:0},padding:"md",children:(0,s.jsxs)(c.Container,{size:"sm",py:"xl",children:[(0,s.jsxs)("header",{style:{marginBottom:"var(--mantine-spacing-xl)"},children:[(0,s.jsxs)(p.Group,{justify:"space-between",mb:"lg",children:[m?(0,s.jsx)(h.Button,{variant:"subtle",color:"gray",size:"sm",onClick:m,children:g}):(0,s.jsx)(h.Button,{component:n(),href:a,variant:"subtle",color:"gray",size:"sm",children:g}),(0,s.jsxs)(p.Group,{gap:"md",children:[(0,s.jsx)(d.Text,{size:"sm",c:"dimmed",children:null==b?void 0:b.username}),(0,s.jsx)(h.Button,{variant:"subtle",color:"gray",size:"sm",onClick:()=>{localStorage.removeItem("admin_token"),localStorage.removeItem("admin_user"),j.push("/admin/login/")},children:"로그아웃"})]})]}),(0,s.jsx)(x.Title,{order:1,fw:300,size:"h2",children:l})]}),(0,s.jsx)("main",{children:t})]})})}}},e=>{e.O(0,[4092,2545,641,6778,4256,5373,8098,2619,6478,9137,903,1702,8441,1255,7358],()=>e(e.s=10479)),_N_E=e.O()}]);