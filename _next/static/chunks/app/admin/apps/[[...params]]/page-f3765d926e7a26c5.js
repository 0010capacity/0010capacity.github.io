(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7744],{37621:(e,t,l)=>{"use strict";l.d(t,{ZQ:()=>s,_H:()=>n,bG:()=>r,nq:()=>o});let a=l(95704).env.NEXT_PUBLIC_API_URL||"http://localhost:8080";async function i(e,t,l,i){let s={"Content-Type":"application/json"};i&&(s.Authorization="Bearer ".concat(i));let n={method:e,headers:s};l&&("POST"===e||"PUT"===e)&&(n.body=JSON.stringify(l));let r=await fetch("".concat(a).concat(t),n);if(!r.ok)throw Error((await r.json().catch(()=>({error:"HTTP ".concat(r.status)}))).error||"API request failed");let o=await r.text();if(o)return JSON.parse(o)}let s={login:e=>i("POST","/api/auth/login",e),register:e=>i("POST","/api/auth/register",e)},n={list:e=>{let t=new URLSearchParams;(null==e?void 0:e.status)&&t.append("status",e.status),(null==e?void 0:e.novel_type)&&t.append("novel_type",e.novel_type),(null==e?void 0:e.genre)&&t.append("genre",e.genre),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.append("offset",e.offset.toString()),(null==e?void 0:e.include_drafts)&&t.append("include_drafts","true");let l=t.toString();return i("GET","/api/novels".concat(l?"?".concat(l):""))},getBySlug:e=>i("GET","/api/novels/".concat(e)),create:(e,t)=>i("POST","/api/novels",e,t),update:(e,t,l)=>i("PUT","/api/novels/".concat(e),t,l),delete:(e,t)=>i("DELETE","/api/novels/".concat(e),void 0,t),getGenres:()=>i("GET","/api/novels/genres"),getNovelTypes:()=>i("GET","/api/novels/types"),getRelations:e=>i("GET","/api/novels/".concat(e,"/relations")),addRelation:(e,t,l)=>i("POST","/api/novels/".concat(e,"/relations"),t,l),removeRelation:(e,t,l)=>i("DELETE","/api/novels/".concat(e,"/relations?related_slug=").concat(t),void 0,l),getChapters:e=>i("GET","/api/novels/".concat(e,"/chapters")),getChapter:(e,t)=>i("GET","/api/novels/".concat(e,"/chapters/").concat(t)),createChapter:(e,t,l)=>i("POST","/api/novels/".concat(e,"/chapters"),t,l),updateChapter:(e,t,l,a)=>i("PUT","/api/novels/".concat(e,"/chapters/").concat(t),l,a),deleteChapter:(e,t,l)=>i("DELETE","/api/novels/".concat(e,"/chapters/").concat(t),void 0,l)},r={list:e=>{let t=new URLSearchParams;(null==e?void 0:e.published)!==void 0&&t.append("published",e.published.toString()),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.append("offset",e.offset.toString());let l=t.toString();return i("GET","/api/blog".concat(l?"?".concat(l):""))},getBySlug:e=>i("GET","/api/blog/".concat(e)),create:(e,t)=>i("POST","/api/blog",e,t),update:(e,t,l)=>i("PUT","/api/blog/".concat(e),t,l),delete:(e,t)=>i("DELETE","/api/blog/".concat(e),void 0,t)},o={list:e=>{let t=new URLSearchParams;(null==e?void 0:e.platform)&&t.append("platform",e.platform),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.append("offset",e.offset.toString());let l=t.toString();return i("GET","/api/apps".concat(l?"?".concat(l):""))},getBySlug:e=>i("GET","/api/apps/".concat(e)),getPlatforms:()=>i("GET","/api/apps/platforms"),getChannels:()=>i("GET","/api/apps/channels"),create:(e,t)=>i("POST","/api/apps",e,t),update:(e,t,l)=>i("PUT","/api/apps/".concat(e),t,l),delete:(e,t)=>i("DELETE","/api/apps/".concat(e),void 0,t)}},50960:(e,t,l)=>{"use strict";l.d(t,{default:()=>N});var a=l(95155),i=l(12115),s=l(20063),n=l(17998),r=l(40387),o=l(63090),c=l(41970),d=l(67661),p=l(70305),u=l(96778),h=l(2369),m=l(82726),g=l(23967),x=l(77147),v=l(58380),j=l(85784),f=l(63498),b=l(60688),y=l(67623),w=l(92364),S=l(6132),T=l(27937),k=l(65229),_=l(86237),C=l(37621);let z=(0,i.createContext)(null);function E(){let e=(0,i.useContext)(z);if(!e)throw Error("useNav must be used within NavProvider");return e}let G=[{id:"ios",name:"iOS",color:"blue"},{id:"android",name:"Android",color:"green"},{id:"web",name:"Web",color:"grape"},{id:"windows",name:"Windows",color:"cyan"},{id:"macos",name:"macOS",color:"gray"},{id:"linux",name:"Linux",color:"orange"},{id:"game",name:"Game",color:"pink"}],B=[{id:"app_store",name:"App Store",placeholder:"https://apps.apple.com/app/..."},{id:"play_store",name:"Google Play",placeholder:"https://play.google.com/store/apps/..."},{id:"web",name:"Web App",placeholder:"https://myapp.com"},{id:"steam",name:"Steam",placeholder:"https://store.steampowered.com/app/..."},{id:"stove",name:"Stove",placeholder:"https://stove.com/..."},{id:"epic",name:"Epic Games",placeholder:"https://store.epicgames.com/..."},{id:"gog",name:"GOG",placeholder:"https://gog.com/game/..."},{id:"itch",name:"itch.io",placeholder:"https://username.itch.io/game"},{id:"landing_page",name:"Landing Page",placeholder:"https://myapp.com/download"},{id:"direct_download",name:"Direct Download",placeholder:"https://myapp.com/download/file.zip"},{id:"github",name:"GitHub Releases",placeholder:"https://github.com/user/repo/releases"},{id:"other",name:"Other",placeholder:"https://..."}];function A(e){let{platform:t}=e,l=G.find(e=>e.id===t);return(0,a.jsx)(n.Badge,{variant:"light",color:(null==l?void 0:l.color)||"gray",size:"sm",radius:"sm",children:(null==l?void 0:l.name)||t})}function P(){let{navigate:e}=E(),[t,l]=(0,i.useState)([]),[s,n]=(0,i.useState)(!0),[v,j]=(0,i.useState)(""),[f,b]=(0,i.useState)(null);(0,i.useEffect)(()=>{y()},[]);let y=async()=>{try{n(!0);let e=await C.nq.list(),t=Array.isArray(e)?e:e.apps||[];l(t)}catch(e){j(e instanceof Error?e.message:"앱 목록을 불러오는데 실패했습니다")}finally{n(!1)}},w=async e=>{let a=localStorage.getItem("admin_token");if(a)try{await C.nq.delete(e,a),l(t.filter(t=>t.slug!==e)),b(null)}catch(e){j(e instanceof Error?e.message:"앱 삭제에 실패했습니다")}};return s?(0,a.jsx)(_.A,{title:"앱 관리",children:(0,a.jsx)(r.Center,{py:"xl",children:(0,a.jsx)(o.Loader,{})})}):v?(0,a.jsx)(_.A,{title:"앱 관리",children:(0,a.jsx)(c.Alert,{icon:(0,a.jsx)(S.A,{size:16}),title:"오류",color:"red",mb:"lg",children:v})}):(0,a.jsxs)(_.A,{title:"앱 관리",children:[(0,a.jsxs)(d.Group,{justify:"space-between",mb:"lg",children:[(0,a.jsxs)(p.Text,{size:"sm",c:"dimmed",children:["총 ",t.length,"개의 앱"]}),(0,a.jsx)(u.Button,{size:"sm",onClick:()=>e({view:"new"}),children:"+ 새 앱 등록"})]}),0===t.length?(0,a.jsx)(r.Center,{py:"xl",children:(0,a.jsxs)(h.Stack,{align:"center",gap:"md",children:[(0,a.jsx)(p.Text,{size:"sm",c:"dimmed",children:"등록된 앱이 없습니다"}),(0,a.jsx)(u.Button,{variant:"subtle",size:"sm",onClick:()=>e({view:"new"}),rightSection:(0,a.jsx)(T.A,{size:16}),children:"첫 번째 앱을 등록해보세요"})]})}):(0,a.jsx)(h.Stack,{gap:"md",children:t.map(t=>(0,a.jsx)(m.Paper,{p:"md",radius:"md",withBorder:!0,children:(0,a.jsxs)(d.Group,{justify:"space-between",align:"flex-start",children:[(0,a.jsxs)(d.Group,{align:"flex-start",gap:"md",children:[t.icon_url&&(0,a.jsx)(g.Image,{src:t.icon_url,alt:t.name,width:64,height:64,radius:"md",fit:"cover"}),(0,a.jsxs)(h.Stack,{gap:"xs",style:{flex:1},children:[(0,a.jsx)(p.Text,{fw:500,children:t.name}),(0,a.jsx)(d.Group,{gap:"xs",wrap:"wrap",children:(t.platforms||[]).map(e=>(0,a.jsx)(A,{platform:e},e))}),t.description&&(0,a.jsx)(p.Text,{size:"sm",c:"dimmed",lineClamp:2,children:t.description}),(t.distribution_channels||[]).length>0&&(0,a.jsx)(d.Group,{gap:"xs",wrap:"wrap",children:t.distribution_channels.map((e,t)=>{let l=B.find(t=>t.id===e.type);return(0,a.jsxs)(x.Anchor,{href:e.url,target:"_blank",rel:"noopener noreferrer",size:"xs",children:[e.label||(null==l?void 0:l.name)||e.type," ","↗"]},t)})})]})]}),(0,a.jsxs)(d.Group,{gap:"xs",children:[(0,a.jsx)(u.Button,{size:"xs",variant:"subtle",onClick:()=>e({view:"edit",slug:t.slug}),children:"수정"}),f===t.slug?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.Button,{size:"xs",color:"red",variant:"subtle",onClick:()=>w(t.slug),children:"확인"}),(0,a.jsx)(u.Button,{size:"xs",variant:"subtle",onClick:()=>b(null),children:"취소"})]}):(0,a.jsx)(u.Button,{size:"xs",color:"red",variant:"subtle",onClick:()=>b(t.slug),children:"삭제"})]})]})},t.id))})]})}function I(e){let{selected:t,onChange:l,disabled:i}=e;return(0,a.jsx)(d.Group,{gap:"xs",wrap:"wrap",children:G.map(e=>(0,a.jsx)(u.Button,{size:"sm",variant:t.includes(e.id)?"filled":"light",onClick:()=>{var a;return a=e.id,void(t.includes(a)?l(t.filter(e=>e!==a)):l([...t,a]))},disabled:i,children:e.name},e.id))})}function L(e){let{channels:t,onChange:l,disabled:i}=e,s=(e,a,i)=>{let s=[...t],n=s[e];if(!n)return;let r={type:n.type,url:n.url,label:n.label};"type"===a?r.type=i:"url"===a?r.url=i:"label"===a&&(r.label=i),s[e]=r,l(s)};return(0,a.jsxs)(h.Stack,{gap:"md",children:[t.map((e,n)=>{var r,o;return(0,a.jsx)(m.Paper,{p:"md",radius:"md",withBorder:!0,children:(0,a.jsxs)(h.Stack,{gap:"md",children:[(0,a.jsxs)(d.Group,{justify:"space-between",children:[(0,a.jsxs)(p.Text,{size:"sm",c:"dimmed",children:["배포 채널 ",n+1]}),(0,a.jsx)(v.ActionIcon,{color:"red",variant:"subtle",size:"sm",onClick:()=>{l(t.filter((e,t)=>t!==n))},disabled:i,children:(0,a.jsx)(k.A,{size:16})})]}),(0,a.jsxs)(j.Grid,{gutter:"md",children:[(0,a.jsx)(j.Grid.Col,{span:{base:12,sm:6},children:(0,a.jsx)(f.Select,{label:"채널 유형",placeholder:"선택하세요",value:e.type,onChange:e=>s(n,"type",e||""),disabled:i,data:B.map(e=>({value:e.id,label:e.name})),size:"sm"})}),(0,a.jsx)(j.Grid.Col,{span:{base:12,sm:6},children:(0,a.jsx)(b.TextInput,{label:"커스텀 라벨 (선택)",placeholder:"예: 한국 앱스토어",value:e.label||"",onChange:e=>s(n,"label",e.target.value),disabled:i,size:"sm"})})]}),(0,a.jsx)(b.TextInput,{label:"URL",type:"url",placeholder:(r=e.type,(null==(o=B.find(e=>e.id===r))?void 0:o.placeholder)||"https://..."),value:e.url,onChange:e=>s(n,"url",e.target.value),disabled:i,size:"sm"})]})},n)}),(0,a.jsx)(u.Button,{variant:"light",fullWidth:!0,onClick:()=>{l([...t,{type:"app_store",url:"",label:""}])},disabled:i,children:"+ 배포 채널 추가"})]})}function O(e){var t;let{initialData:l,onSubmit:s,isEdit:n=!1}=e,{navigate:r}=E(),[o,m]=(0,i.useState)(!1),[x,j]=(0,i.useState)(""),[f,T]=(0,i.useState)({name:(null==l?void 0:l.name)||"",description:(null==l?void 0:l.description)||"",platforms:(null==l?void 0:l.platforms)||[],icon_url:(null==l?void 0:l.icon_url)||"",screenshots:(null==l||null==(t=l.screenshots)?void 0:t.length)?l.screenshots:[],distribution_channels:(null==l?void 0:l.distribution_channels)||[],privacy_policy_url:(null==l?void 0:l.privacy_policy_url)||""}),_=async e=>{e.preventDefault(),j(""),m(!0);let t={...f,screenshots:f.screenshots.filter(e=>""!==e.trim()),distribution_channels:f.distribution_channels.filter(e=>""!==e.url.trim())};try{await s(t)}catch(e){j(e instanceof Error?e.message:"저장에 실패했습니다")}finally{m(!1)}};return(0,a.jsx)(y.Box,{component:"form",onSubmit:_,maw:600,children:(0,a.jsxs)(h.Stack,{gap:"xl",children:[x&&(0,a.jsx)(c.Alert,{icon:(0,a.jsx)(S.A,{size:16}),title:"오류",color:"red",children:x}),(0,a.jsxs)(h.Stack,{gap:"md",children:[(0,a.jsx)(p.Text,{size:"lg",fw:600,children:"기본 정보"}),(0,a.jsx)(b.TextInput,{label:"앱 이름 *",placeholder:"앱 이름을 입력하세요",value:f.name,onChange:e=>T({...f,name:e.target.value}),disabled:o,required:!0,size:"sm"}),(0,a.jsxs)(h.Stack,{gap:"xs",children:[(0,a.jsx)(p.Text,{size:"sm",fw:500,children:"플랫폼 (복수 선택 가능)"}),(0,a.jsx)(I,{selected:f.platforms,onChange:e=>T({...f,platforms:e}),disabled:o})]}),(0,a.jsx)(w.Textarea,{label:"설명",placeholder:"앱에 대한 간단한 설명을 입력하세요",value:f.description,onChange:e=>T({...f,description:e.target.value}),disabled:o,minRows:4,size:"sm"})]}),(0,a.jsxs)(h.Stack,{gap:"md",children:[(0,a.jsxs)(h.Stack,{gap:"xs",children:[(0,a.jsx)(p.Text,{size:"lg",fw:600,children:"배포 채널"}),(0,a.jsx)(p.Text,{size:"sm",c:"dimmed",children:"앱이 배포되는 스토어, 웹사이트 등의 링크를 추가하세요."})]}),(0,a.jsx)(L,{channels:f.distribution_channels,onChange:e=>T({...f,distribution_channels:e}),disabled:o})]}),(0,a.jsxs)(h.Stack,{gap:"md",children:[(0,a.jsx)(p.Text,{size:"lg",fw:600,children:"미디어"}),(0,a.jsxs)(h.Stack,{gap:"xs",children:[(0,a.jsx)(b.TextInput,{label:"앱 아이콘 URL",placeholder:"https://example.com/icon.png",value:f.icon_url,onChange:e=>T({...f,icon_url:e.target.value}),disabled:o,type:"url",size:"sm"}),f.icon_url&&(0,a.jsx)(g.Image,{src:f.icon_url,alt:"Icon preview",width:64,height:64,radius:"md",fit:"cover"})]}),(0,a.jsxs)(h.Stack,{gap:"md",children:[(0,a.jsx)(p.Text,{size:"sm",fw:500,children:"스크린샷"}),f.screenshots.map((e,t)=>(0,a.jsxs)(h.Stack,{gap:"xs",children:[(0,a.jsxs)(d.Group,{gap:"xs",children:[(0,a.jsx)(b.TextInput,{type:"url",placeholder:"스크린샷 URL ".concat(t+1),value:e,onChange:e=>((e,t)=>{let l=[...f.screenshots];l[e]=t,T({...f,screenshots:l})})(t,e.target.value),disabled:o,size:"sm",style:{flex:1}}),(0,a.jsx)(v.ActionIcon,{color:"red",variant:"subtle",onClick:()=>{T({...f,screenshots:f.screenshots.filter((e,l)=>l!==t)})},disabled:o,children:(0,a.jsx)(k.A,{size:16})})]}),e&&(0,a.jsx)(g.Image,{src:e,alt:"Screenshot ".concat(t+1),height:160,width:100,radius:"md",fit:"cover"})]},t)),(0,a.jsx)(u.Button,{variant:"subtle",size:"sm",onClick:()=>{T({...f,screenshots:[...f.screenshots,""]})},disabled:o,children:"+ 스크린샷 추가"})]})]}),(0,a.jsxs)(h.Stack,{gap:"md",children:[(0,a.jsx)(p.Text,{size:"lg",fw:600,children:"추가 정보"}),(0,a.jsx)(b.TextInput,{label:"개인정보처리방침 URL",placeholder:"https://example.com/privacy",value:f.privacy_policy_url,onChange:e=>T({...f,privacy_policy_url:e.target.value}),disabled:o,type:"url",size:"sm"})]}),(0,a.jsxs)(d.Group,{justify:"flex-start",pt:"md",children:[(0,a.jsx)(u.Button,{type:"submit",disabled:o||!f.name,loading:o,children:n?"저장":"앱 등록"}),(0,a.jsx)(u.Button,{variant:"subtle",onClick:()=>r({view:"list"}),disabled:o,children:"취소"})]})]})})}function R(){let{navigate:e}=E(),t=async t=>{let l=localStorage.getItem("admin_token");if(!l)throw Error("로그인이 필요합니다");await C.nq.create(t,l),e({view:"list"})};return(0,a.jsx)(_.A,{title:"새 앱 등록",backHref:"/admin/apps",backLabel:"← 앱 목록",onBack:()=>e({view:"list"}),children:(0,a.jsx)(O,{onSubmit:t})})}function U(e){let{slug:t}=e,{navigate:l}=E(),[s,n]=(0,i.useState)(null),[d,p]=(0,i.useState)(!0),[u,h]=(0,i.useState)("");(0,i.useEffect)(()=>{(async()=>{try{p(!0);let e=await C.nq.getBySlug(t);n(e)}catch(e){h(e instanceof Error?e.message:"앱을 불러오는데 실패했습니다")}finally{p(!1)}})()},[t]);let m=async e=>{let a=localStorage.getItem("admin_token");if(!a)throw Error("로그인이 필요합니다");await C.nq.update(t,e,a),l({view:"list"})};return d?(0,a.jsx)(_.A,{title:"앱 수정",backHref:"/admin/apps",backLabel:"← 앱 목록",onBack:()=>l({view:"list"}),children:(0,a.jsx)(r.Center,{py:"xl",children:(0,a.jsx)(o.Loader,{})})}):u?(0,a.jsx)(_.A,{title:"앱 수정",backHref:"/admin/apps",backLabel:"← 앱 목록",onBack:()=>l({view:"list"}),children:(0,a.jsx)(c.Alert,{icon:(0,a.jsx)(S.A,{size:16}),title:"오류",color:"red",children:u})}):(0,a.jsx)(_.A,{title:"앱 수정",backHref:"/admin/apps",backLabel:"← 앱 목록",onBack:()=>l({view:"list"}),children:(0,a.jsx)(O,{initialData:s||void 0,onSubmit:m,isEdit:!0})})}function N(){let e=(0,s.usePathname)(),[t,l]=(0,i.useState)({view:"list"}),[n,r]=(0,i.useState)([]),[o,c]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(o)return;let t=e.split("/").filter(Boolean);3===t.length&&"new"===t[2]?l({view:"new"}):4===t.length&&"edit"===t[3]&&l({view:"edit",slug:t[2]}),c(!0)},[e,o]);let d=(0,i.useCallback)(e=>{r(e=>[...e,t]),l(e)},[t]),p=(0,i.useCallback)(()=>{if(n.length>0){let e=[...n],t=e.pop();r(e),l(t||{view:"list"})}else l({view:"list"})},[n]);return(0,a.jsx)(z.Provider,{value:{navState:t,navigate:d,goBack:p},children:(()=>{switch(t.view){case"new":return(0,a.jsx)(R,{});case"edit":return t.slug?(0,a.jsx)(U,{slug:t.slug}):(0,a.jsx)(P,{});default:return(0,a.jsx)(P,{})}})()})}},86237:(e,t,l)=>{"use strict";l.d(t,{A:()=>g});var a=l(95155),i=l(52619),s=l.n(i),n=l(20063),r=l(12115),o=l(13877),c=l(63090),d=l(70305),p=l(75802),u=l(67661),h=l(96778),m=l(74264);function g(e){let{children:t,title:l,backHref:i="/admin/dashboard",backLabel:g="← 대시보드",onBack:x}=e,v=(0,n.useRouter)(),[j,f]=(0,r.useState)(null),[b,y]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{let e=localStorage.getItem("admin_token"),t=localStorage.getItem("admin_user");if(!e||!t)return void v.push("/admin/login/");f(JSON.parse(t)),y(!1)},[v]),b)?(0,a.jsxs)(o.Container,{h:"100vh",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,a.jsx)(c.Loader,{color:"gray",size:"sm"}),(0,a.jsx)(d.Text,{size:"sm",c:"dimmed",ml:"sm",children:"로딩 중..."})]}):(0,a.jsx)(p.AppShell,{header:{height:0},padding:"md",children:(0,a.jsxs)(o.Container,{size:"sm",py:"xl",children:[(0,a.jsxs)("header",{style:{marginBottom:"var(--mantine-spacing-xl)"},children:[(0,a.jsxs)(u.Group,{justify:"space-between",mb:"lg",children:[x?(0,a.jsx)(h.Button,{variant:"subtle",color:"gray",size:"sm",onClick:x,children:g}):(0,a.jsx)(h.Button,{component:s(),href:i,variant:"subtle",color:"gray",size:"sm",children:g}),(0,a.jsxs)(u.Group,{gap:"md",children:[(0,a.jsx)(d.Text,{size:"sm",c:"dimmed",children:null==j?void 0:j.username}),(0,a.jsx)(h.Button,{variant:"subtle",color:"gray",size:"sm",onClick:()=>{localStorage.removeItem("admin_token"),localStorage.removeItem("admin_user"),v.push("/admin/login/")},children:"로그아웃"})]})]}),(0,a.jsx)(m.Title,{order:1,fw:300,size:"h2",children:l})]}),(0,a.jsx)("main",{children:t})]})})}},88384:(e,t,l)=>{Promise.resolve().then(l.bind(l,50960))}},e=>{e.O(0,[2545,641,6778,4256,5373,8098,2619,6478,9748,2222,8441,1255,7358],()=>e(e.s=88384)),_N_E=e.O()}]);